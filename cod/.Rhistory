# fechas de cup贸n
venc.cupones1 <- seq(
from = 2 / 12,
to   = 10,
by   = 2 / 12)
pagos1 <- match(ceiling(venc.cupones * 100)/100, CCC.colones$vencimiento)
sum(CCC.colones$precio[pagos])*21000000 * 0.04 + CCC.colones$precio[12*10+1]*21000000
# fechas de cup贸n
venc.cupones1 <- seq(
from = 2 / 12,
to   = 10,
by   = 2 / 12)
pagos1 <- match(ceiling(venc.cupones1 * 100)/100, CCC.colones$vencimiento)
sum(CCC.colones$precio[pagos1])*21000000 * 0.04 + CCC.colones$precio[12*10+1]*21000000
# fechas de cup贸n
venc.cupones1 <- seq(
from = 2 / 12,
to   = 10,
by   = 2 / 12)
pagos1 <- match(ceiling(venc.cupones1 * 100)/100, CCC.colones$vencimiento)
total1 <- sum(CCC.colones$precio[pagos1])*21000000 * 0.04 + CCC.colones$precio[12*10+1]*21000000
venc.cupones2 <- seq(
from = 3 / 12,
to   = 12,
by   = 3 / 12)
pagos2 <- match(ceiling(venc.cupones2 * 100)/100, CCC.colones$vencimiento)
total2 <- sum(CCC.colones$precio[pagos2])*21000000 * 0.06 + CCC.colones$precio[12*12+1]*21000000
venc.cupones3 <- seq(
from = 4 / 12,
to   = 15,
by   = 4 / 12)
pagos3 <- match(ceiling(venc.cupones3 * 100)/100, CCC.colones$vencimiento)
total3 <- sum(CCC.colones$precio[pagos3])*21000000 * 0.07 + CCC.colones$precio[12*15+1]*21000000
venc.cupones4 <- seq(
from = 12 / 12,
to   = 18,
by   = 12 / 12)
pagos4 <- match(ceiling(venc.cupones4 * 100)/100, CCC.colones$vencimiento)
total4 <- sum(CCC.colones$precio[pagos4])*21000000 * 0.09 + CCC.colones$precio[12*18+1]*21000000
total1+total2+total3+total4
ajustar.distribucion <- function(
x,
distribuciones = c("lnorm", "weibull", "norm"),
criterio = c("AIC","BIC"))
{
criterio <- match.arg(criterio)
x <- x[is.finite(x) & x > 0]
if(length(x) < 10) stop("Muy pocos datos para ajustar distribuciones.")
fits <- list()
for(d in distribuciones){
fit <- tryCatch(
suppressWarnings(fitdistrplus::fitdist(x, d)),
error = function(e) NULL
)
if(!is.null(fit) && all(is.finite(fit$estimate))) fits[[d]] <- fit
}
if(length(fits) == 0) stop("Ninguna distribuci贸n pudo ajustarse.")
tabla <- do.call(rbind, lapply(names(fits), function(d){
fit <- fits[[d]]
data.frame(Distribucion = d, AIC = AIC(fit), BIC = BIC(fit))
}))
mejor <- tabla$Distribucion[which.min(tabla[[criterio]])]
list(metricas = tabla, mejor = mejor, fits = fits)
}
portafolio.h4 <- montecarlo(S = 4, u2.CRC = 1.0003, d2.CRC = 0.9997, u.CRC = 1.061934, d.CRC = 0.9416777,
u2.USD = 1.00005, d2.USD = 0.99995, u.USD = 1.043396, d.USD = 0.9584087,
curva.CRC = CCC.colones, curva.USD = CCC.dolares,
valor.accion.CRC = 23000, cant.acciones.CRC = 600,
valor.accion.USD = 135, cant.acciones.USD = 400,
valor.bonos.CRC = 12000000, venc.bonos.CRC = c(3, 8, 15, 20),
valor.bonos.USD = 14500, venc.bonos.USD = c(5, 10, 16),
valor.bonos.cuponados.CRC = 21000000, venc.bonos.cuponados.CRC = c(10, 12, 15, 18),
periodo.cupon.CRC = c(2, 3, 4, 12), cupon.CRC = c(0.04, 0.06, 0.07, 0.09),
valor.bonos.cuponados.USD = 30000, venc.bonos.cuponados.USD = c(17),
periodo.cupon.USD = c(12), cupon.USD = c(0.06),
tipo.cambio = 498.19,
cant.simulaciones = 10000)
write.csv(
portafolio.h4,
file = "../Resultados/valor_portafolio_h4.csv",
row.names = FALSE
)
head(portafolio.h4)
h4 <- portafolio.h4$total.portafolio
res.h4 <- ajustar.distribucion(h4, criterio = "AIC")
grafica.h4 <- graficar.ajuste(
x = h4,
distribucion = res.h4$mejor,
titulo = paste0("Portafolio en horizonte de 4 a帽os con ajuste ", res.h4$mejor),
horizonte = 4
)
graficar.ajuste <- function(
x,
distribucion = c("lnorm", "weibull", "norm"),
titulo = "Ajuste de distribuci贸n",
horizonte = NULL
){
distribucion <- match.arg(distribucion)
# Limpieza
x <- x[is.finite(x) & x > 0]
if(length(x) < 10){
stop("Muy pocos datos para graficar.")
}
#  Mapeo correcto para MASS::fitdistr
dist_mass <- switch(
distribucion,
lnorm   = "lognormal",
norm    = "normal",
weibull = "weibull"
)
# Ajuste MLE
fit <- MASS::fitdistr(x, dist_mass)
est <- fit$estimate
# Media, desviaci贸n y densidad
if(distribucion == "lnorm"){
media <- exp(est["meanlog"] + est["sdlog"]^2 / 2)
desv  <- sqrt((exp(est["sdlog"]^2) - 1) * exp(2*est["meanlog"] + est["sdlog"]^2))
dens_fun  <- dlnorm
dens_args <- list(meanlog = est["meanlog"], sdlog = est["sdlog"])
} else if(distribucion == "weibull"){
media <- est["scale"] * gamma(1 + 1 / est["shape"])
desv  <- sqrt(est["scale"]^2 *
(gamma(1 + 2/est["shape"]) -
gamma(1 + 1/est["shape"])^2))
dens_fun  <- dweibull
dens_args <- list(shape = est["shape"], scale = est["scale"])
} else if(distribucion == "norm"){
media <- est["mean"]
desv  <- est["sd"]
dens_fun  <- dnorm
dens_args <- list(mean = est["mean"], sd = est["sd"])
}
subtitulo <- paste0(
if(!is.null(horizonte)) paste0("Horizonte: ", horizonte, " a帽os | ") else "",
"Media = ", round(media / 1e6, 2), " M",
" | Desv.Est = ", round(desv / 1e6, 2), " M"
)
ggplot(tibble(x = x), aes(x = x)) +
geom_histogram(
aes(y = after_stat(density)),
bins = nclass.FD(x),
fill = "#4E79A7",
color = "white",
alpha = 0.85
) +
stat_function(
fun = dens_fun,
args = dens_args,
linewidth = 1.5,
color = "#E15759"
) +
scale_x_continuous(
labels = label_number(scale = 1e-6, suffix = " M")
) +
labs(
title = titulo,
subtitle = subtitulo,
x = "Valor del portafolio (millones)",
y = "Densidad"
) +
theme_minimal(base_size = 10) +
theme(
plot.title = element_text(face = "bold"),
panel.grid.minor = element_blank()
)
}
h4 <- portafolio.h4$total.portafolio
res.h4 <- ajustar.distribucion(h4, criterio = "AIC")
grafica.h4 <- graficar.ajuste(
x = h4,
distribucion = res.h4$mejor,
titulo = paste0("Portafolio en horizonte de 4 a帽os con ajuste ", res.h4$mejor),
horizonte = 4
)
res.h4
grafica.h4
ggsave(
filename = "../Resultados/portafolio_h4_lognormal.jpg",
plot = grafica.h4,
width = 8,
height = 5,
units = "in",
dpi = 300
)
portafolio.h7 <- montecarlo(S = 7, u2.CRC = 1.0003, d2.CRC = 0.9997, u.CRC = 1.061934, d.CRC = 0.9416777,
u2.USD = 1.00005, d2.USD = 0.99995, u.USD = 1.043396, d.USD = 0.9584087,
curva.CRC = CCC.colones, curva.USD = CCC.dolares,
valor.accion.CRC = 23000, cant.acciones.CRC = 600,
valor.accion.USD = 135, cant.acciones.USD = 400,
valor.bonos.CRC = 12000000, venc.bonos.CRC = c(3, 8, 15, 20),
valor.bonos.USD = 14500, venc.bonos.USD = c(5, 10, 16),
valor.bonos.cuponados.CRC = 21000000, venc.bonos.cuponados.CRC = c(10, 12, 15, 18),
periodo.cupon.CRC = c(2, 3, 4, 12), cupon.CRC = c(0.04, 0.06, 0.07, 0.09),
valor.bonos.cuponados.USD = 30000, venc.bonos.cuponados.USD = c(17),
periodo.cupon.USD = c(12), cupon.USD = c(0.06),
tipo.cambio = 498.19,
cant.simulaciones = 10000)
write.csv(
portafolio.h7,
file = "../Resultados/valor_portafolio_h7.csv",
row.names = FALSE
)
head(portafolio.h7)
h7 <- portafolio.h7$total.portafolio
res.h7 <- ajustar.distribucion(h7, criterio = "AIC")
grafica.h7 <- graficar.ajuste(
x = h7,
distribucion = res.h7$mejor,
titulo = paste0("Portafolio en horizonte de 7 a帽os con ajuste ", res.h7$mejor),
horizonte = 7
)
res.h7
grafica.h7
ggsave(
filename = "../Resultados/portafolio_h7_lognormal.jpg",
plot = grafica.h7,
width = 8,
height = 5,
units = "in",
dpi = 300
)
portafolio.h10 <- montecarlo(S = 10, u2.CRC = 1.0003, d2.CRC = 0.9997, u.CRC = 1.061934, d.CRC = 0.9416777,
u2.USD = 1.00005, d2.USD = 0.99995, u.USD = 1.043396, d.USD = 0.9584087,
curva.CRC = CCC.colones, curva.USD = CCC.dolares,
valor.accion.CRC = 23000, cant.acciones.CRC = 600,
valor.accion.USD = 135, cant.acciones.USD = 400,
valor.bonos.CRC = 12000000, venc.bonos.CRC = c(3, 8, 15, 20),
valor.bonos.USD = 14500, venc.bonos.USD = c(5, 10, 16),
valor.bonos.cuponados.CRC = 21000000, venc.bonos.cuponados.CRC = c(10, 12, 15, 18),
periodo.cupon.CRC = c(2, 3, 4, 12), cupon.CRC = c(0.04, 0.06, 0.07, 0.09),
valor.bonos.cuponados.USD = 30000, venc.bonos.cuponados.USD = c(17),
periodo.cupon.USD = c(12), cupon.USD = c(0.06),
tipo.cambio = 498.19,
cant.simulaciones = 10000)
write.csv(
portafolio.h10,
file = "../Resultados/valor_portafolio_h10.csv",
row.names = FALSE
)
head(portafolio.h10)
h10 <- portafolio.h10$total.portafolio
res.h10 <- ajustar.distribucion(h10, criterio = "AIC")
grafica.h10 <- graficar.ajuste(
x = h10,
distribucion = res.h10$mejor,
titulo = paste0("Portafolio en horizonte de 10 a帽os con ajuste ", res.h10$mejor),
horizonte = 10
)
res.h10
grafica.h10
ggsave(
filename = "../Resultados/portafolio_h10_lognormal.jpg",
plot = grafica.h10,
width = 8,
height = 5,
units = "in",
dpi = 300
)
portafolio.h15 <- montecarlo(S = 15, u2.CRC = 1.0003, d2.CRC = 0.9997, u.CRC = 1.061934, d.CRC = 0.9416777,
u2.USD = 1.00005, d2.USD = 0.99995, u.USD = 1.043396, d.USD = 0.9584087,
curva.CRC = CCC.colones, curva.USD = CCC.dolares,
valor.accion.CRC = 23000, cant.acciones.CRC = 600,
valor.accion.USD = 135, cant.acciones.USD = 400,
valor.bonos.CRC = 12000000, venc.bonos.CRC = c(3, 8, 15, 20),
valor.bonos.USD = 14500, venc.bonos.USD = c(5, 10, 16),
valor.bonos.cuponados.CRC = 21000000, venc.bonos.cuponados.CRC = c(10, 12, 15, 18),
periodo.cupon.CRC = c(2, 3, 4, 12), cupon.CRC = c(0.04, 0.06, 0.07, 0.09),
valor.bonos.cuponados.USD = 30000, venc.bonos.cuponados.USD = c(17),
periodo.cupon.USD = c(12), cupon.USD = c(0.06),
tipo.cambio = 498.19,
cant.simulaciones = 10000)
write.csv(
portafolio.h15,
file = "../Resultados/valor_portafolio_h15.csv",
row.names = FALSE
)
head(portafolio.h15)
h15 <- portafolio.h15$total.portafolio
res.h15 <- ajustar.distribucion(h15, criterio = "AIC")
grafica.h15 <- graficar.ajuste(
x = h15,
distribucion = res.h15$mejor,
titulo = paste0("Portafolio en horizonte de 15 a帽os con ajuste ", res.h15$mejor),
horizonte = 15
)
grafica.h15
ggsave(
filename = "../Resultados/portafolio_h15_lognormal.jpg",
plot = grafica.h15,
width = 8,
height = 5,
units = "in",
dpi = 300
)
valorar.compra.acciones <- function(S, u2, d2, u, d,
curva, valor.accion, cant.acciones.nuevas,
Kf, cant.simulaciones){
cant.p <- as.integer(ceiling(S * 12))
K <- max(Kf - 5000, 0)
# vectores para guardar los valores de las simulaciones
acciones.vec <- numeric(cant.simulaciones)
compra.directa.vec <- numeric(cant.simulaciones)
call.europea.vec <- numeric(cant.simulaciones)
for(sim in 1:cant.simulaciones){
# trayectoria
trayectoria.tasa.corta <- trayectoria(u2, d2, cant.p)
# tasa corta
tasa.corta <- modelo.ho.lee(u2, d2, curva, cant.p, trayectoria.tasa.corta)
# mercado de acciones
acciones <- mercado.acciones(
u2 = u2, d2 = d2,
u = u, d = d,
curva = curva,
cant.periodos = cant.p,
valor.accion = valor.accion,
tasa.corta = tasa.corta
)$valor.accion[cant.p + 1]
# Compra de acciones directa (independiente al valor que tome la accion)
compra.directa <- cant.acciones.nuevas * acciones
# Compra de acciones mediante una opcion call (depende del valor que tome la accion en ese momento y el strike)
call.europea <- cant.acciones.nuevas * pmax(acciones - K, 0)
# se guarda la informaci贸n
acciones.vec[sim] <- acciones
compra.directa.vec[sim] <- compra.directa
call.europea.vec[sim] <- call.europea
}
return(data.frame(
simulacion = 1:cant.simulaciones,
acciones = acciones.vec,
compra.directa = compra.directa.vec,
call.europea = call.europea.vec
))
}
Kf <- 23000 * exp(15 * 12 * 0.0035)
nuevas.acciones <- valorar.compra.acciones(S = 15, u2 = 1.0003, d2 = 0.9997,
u = 1.061934, d = 0.9416777,
curva = CCC.colones, valor.accion = 23000,
cant.acciones.nuevas = 300, Kf = Kf, cant.simulaciones = 10000)
write.csv(
nuevas.acciones,
file = "../Resultados/nuevas_acciones.csv",
row.names = FALSE
)
head(nuevas.acciones)
acumular.hasta.S <- function(S, venc, valores.tasa.corta){
tiempo.i <- as.integer(ceiling(venc * 12))
tiempo.f <- as.integer(ceiling(S * 12))
# Caso en el que el tiempo inicial sea mayor al tiempo final
if(tiempo.i >= tiempo.f){
return(1)
}
# caso contrario: se extraen los valores del vector de tasa corta que est茅n entre [tiempo.i + 1, tiempo.f]
# Nota: el periodo de valores.trayectoria comienza en t=0.
# Nota 2: recordar que rt es la tasa corta que acumula entre [t, t + 1]
tasas <- valores.tasa.corta[(tiempo.i + 1):(tiempo.f)]
# factor de acumulaci贸n: (1 + R) = e^{sum (rt)}
return(exp(sum(tasas) * 1/12))
}
valor.bonos.cuponados <- function(S, curva, venc, periodo.cupon, valor, cupon,
u2 = NULL, d2 = NULL, tasa.corta = NULL){
montos <- numeric(length(venc))
for(indice in seq_along(venc)){
# fechas de cup贸n
venc.cupones <- seq(
from = periodo.cupon[indice] / 12,
to   = venc[indice],
by   = periodo.cupon[indice] / 12
)
# valor del cup贸n
valor.cupon <- valor * cupon[indice]
# Valor total en S de los cupones y principal para un bono cuponado
cupones   <- valor.bonos(S, curva, venc.cupones, valor.cupon, u2, d2, tasa.corta)
principal <- valor.bonos(S, curva, venc[indice],  valor,    u2, d2, tasa.corta)
montos[indice] <- cupones + principal
}
sum(montos)
}
montecarlo <- function(S, u2.CRC, d2.CRC, u.CRC, d.CRC,
u2.USD, d2.USD, u.USD, d.USD,
curva.CRC, curva.USD,
valor.accion.CRC, cant.acciones.CRC,
valor.accion.USD, cant.acciones.USD,
valor.bonos.CRC, venc.bonos.CRC,
valor.bonos.USD, venc.bonos.USD,
valor.bonos.cuponados.CRC, venc.bonos.cuponados.CRC,
periodo.cupon.CRC, cupon.CRC,
valor.bonos.cuponados.USD, venc.bonos.cuponados.USD,
periodo.cupon.USD, cupon.USD,
tipo.cambio,
cant.simulaciones){
cant.p <- as.integer(ceiling(S * 12 * 100) / 100)
tipo.cambio.f <- tipo.cambio.forward(S, tipo.cambio, curva.CRC, curva.USD)
# vectores para guardar la informaci贸n de cada simulaci贸n
acciones.CRC.vec <- numeric(cant.simulaciones)
bonos.cero.cupon.CRC.vec <- numeric(cant.simulaciones)
bonos.cuponados.CRC.vec <- numeric(cant.simulaciones)
acciones.USD.vec <- numeric(cant.simulaciones)
bonos.cero.cupon.USD.vec <- numeric(cant.simulaciones)
bonos.cuponados.USD.vec <- numeric(cant.simulaciones)
portafolio.CRC.vec <- numeric(cant.simulaciones)
portafolio.USD.vec <- numeric(cant.simulaciones)
tipo.cambio.forward.vec <- numeric(cant.simulaciones)
total.portafolio.vec <- numeric(cant.simulaciones)
total.portafolio.TCF.vec <- numeric(cant.simulaciones)
Ut.tasa.corta.CRC.vec <- numeric(cant.simulaciones)
Ut.tasa.corta.USD.vec <- numeric(cant.simulaciones)
for(sim in 1:cant.simulaciones){
# trayectorias
trayectoria.tasa.corta.CRC <- trayectoria(u2.CRC, d2.CRC, cant.p)
trayectoria.tasa.corta.USD <- trayectoria(u2.USD, d2.USD, cant.p)
# tasas cortas
## Costa Rica
tasa.corta.CRC <- modelo.ho.lee(u2 = u2.CRC, d2 = d2.CRC,
curva = curva.CRC, cant.periodos = cant.p,
trayectoria.tasa.corta = trayectoria.tasa.corta.CRC)
## Estados Unidos
tasa.corta.USD <- modelo.ho.lee(u2 = u2.USD, d2 = d2.USD,
curva = curva.USD, cant.periodos = cant.p,
trayectoria.tasa.corta = trayectoria.tasa.corta.USD)
# mercado de Costa Rica
## mercado de acciones Costa Rica
acciones.CRC <- mercado.acciones(u2 = u2.CRC, d2 = d2.CRC,
u = u.CRC, d = d.CRC,
curva = curva.CRC,
cant.periodos = cant.p,
valor.accion = valor.accion.CRC,
tasa.corta.CRC)$valor.accion[cant.p + 1] * cant.acciones.CRC
## Bonos cero cup贸n de Costa Rica
bonos.CRC <- valor.bonos(S = S, curva = curva.CRC,
venc = venc.bonos.CRC, valor = valor.bonos.CRC,
u2 = u2.CRC, d2 = d2.CRC, tasa.corta = tasa.corta.CRC)
## Bonos cuponados de Costa Rica
bonos.cuponados.CRC <- valor.bonos.cuponados(S = S, curva = curva.CRC,
venc = venc.bonos.cuponados.CRC,
periodo.cupon = periodo.cupon.CRC,
valor = valor.bonos.cuponados.CRC,
cupon = cupon.CRC,
u2 = u2.CRC, d2 = d2.CRC,
tasa.corta = tasa.corta.CRC)
# Mercado de Estados Unidos
## mercado de acciones Estados Unidos
acciones.USD <- mercado.acciones(u2 = u2.USD, d2 = d2.USD,
u = u.USD, d = d.USD,
curva = curva.USD, cant.periodos = cant.p,
valor.accion = valor.accion.USD,
tasa.corta = tasa.corta.USD)$valor.accion[cant.p + 1] * cant.acciones.USD
## Bonos cero cup贸n de Estados Unidos
bonos.USD <- valor.bonos(S = S, curva = curva.USD,
venc = venc.bonos.USD, valor = valor.bonos.USD,
u2 = u2.USD, d2 = d2.USD, tasa.corta = tasa.corta.USD)
## Bonos cuponados de Estados Unidos
bonos.cuponados.USD <- valor.bonos.cuponados(S = S, curva = curva.USD,
venc = venc.bonos.cuponados.USD,
periodo.cupon = periodo.cupon.USD,
valor = valor.bonos.cuponados.USD,
cupon = cupon.USD,
u2 = u2.USD, d2 = d2.USD,
tasa.corta = tasa.corta.USD)
# Valor del portafolio de las acciones, bonos cero cupon y bonos cuponados de Costa Rica
portafolio.CRC <- acciones.CRC + bonos.CRC + bonos.cuponados.CRC
# Valor del portafolio de las acciones, bonos cero cupon y bonos cuponados de Estados Unidos
portafolio.USD <- acciones.USD + bonos.USD + bonos.cuponados.USD
# Valor total del portafolio en colones
portafolio <- portafolio.CRC + portafolio.USD * tipo.cambio.f
# valor total del portafolio en colones asumiendo tipo de cambio fijo
portafolio.TCF <- portafolio.CRC + portafolio.USD * tipo.cambio
# se guarda la informaci贸n
acciones.CRC.vec[sim] <- acciones.CRC
bonos.cero.cupon.CRC.vec[sim] <- bonos.CRC
bonos.cuponados.CRC.vec[sim] <- bonos.cuponados.CRC
acciones.USD.vec[sim] <- acciones.USD
bonos.cero.cupon.USD.vec[sim] <- bonos.USD
bonos.cuponados.USD.vec[sim] <- bonos.cuponados.USD
portafolio.CRC.vec[sim] <- portafolio.CRC
portafolio.USD.vec[sim] <- portafolio.USD
tipo.cambio.forward.vec[sim] <- tipo.cambio.f
total.portafolio.vec[sim] <- portafolio
total.portafolio.TCF.vec[sim] <- portafolio.TCF
Ut.tasa.corta.CRC.vec[sim] <- sum(trayectoria.tasa.corta.CRC)
Ut.tasa.corta.USD.vec[sim] <- sum(trayectoria.tasa.corta.USD)
}
return(data.frame(
simulacion = c(1:cant.simulaciones),
acciones.CRC = acciones.CRC.vec,
bonos.cero.cupon.CRC = bonos.cero.cupon.CRC.vec,
bonos.cuponados.CRC = bonos.cuponados.CRC.vec,
acciones.USD = acciones.USD.vec,
bonos.cero.cupon.USD = bonos.cero.cupon.USD.vec,
bonos.cuponados.USD = bonos.cuponados.USD.vec,
portafolio.CRC = portafolio.CRC.vec,
portafolio.USD = portafolio.USD.vec,
tipo.cambio = tipo.cambio.forward.vec,
total.portafolio = total.portafolio.vec,
total.portafolio.TCF = total.portafolio.TCF.vec,
Ut.tasa.corta.CRC = Ut.tasa.corta.CRC.vec,
Ut.tasa.corta.USD = Ut.tasa.corta.USD.vec
))
}
tipo.cambio.forward <- function(S, tipo.cambio.actual, curva.CRC, curva.USD){
# se redondea hacia arriba a dos decimales
S <- ceiling(S * 100) / 100
# se escoje la posicion de vencimiento que sea m谩s cercana
S.CRC <- which.min(abs(curva.CRC$vencimiento - S))
S.USD <- which.min(abs(curva.USD$vencimiento - S))
# Precio cero cupon P(0, S) de Costa Rica
data.S.CRC <- curva.CRC$precio[S.CRC]
# Precio cero cupon P(0, S) de Estados Unidos
data.S.USD <- curva.USD$precio[S.USD]
# tipo de cambio forward CRC/USD
tipo.cambio <- tipo.cambio.actual * data.S.USD / data.S.CRC
return(tipo.cambio)
}
